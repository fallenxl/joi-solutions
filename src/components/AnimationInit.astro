---
import LogoIcon from "../icons/LogoIcon.astro";
---

<div
  class="animation-container fixed top-0 left-0 w-full h-dvh items-center justify-center bg-white text-white text-5xl z-50 hidden"
>
  <LogoIcon className="z-[60] hidden" />
  <div
    class="bg-animation-secondary bg-principal h-dvh w-full fixed top-0 left-0 z-40 scale-y-0"
  >
  </div>
</div>

<script>
  import gsap from "gsap";

  // Helper para seleccionar y lanzar error si falta un elemento
  const $ = (selector: string): HTMLElement => {
    const el = document.querySelector(selector);
    if (!el) throw new Error(`Elemento no encontrado: ${selector}`);
    return el as HTMLElement;
  };

  // Referencias a elementos
  const animationContainer = $(".animation-container");
  const bgAnimationSecondary = $(".bg-animation-secondary");
  const logoContainer = $(".logo-container");
  const logoFirstText = $(".logo-first-text");
  const logoSecondText = $(".logo-second-text");
  const logoSeparator = $(".logo-separator");

  // Timeline principal
  const tl = gsap.timeline({ defaults: { duration: 0.5, ease: "power2.out" } });

  tl.set(animationContainer, { display: "flex" })
    .set(logoContainer, { display: "flex" })
    .to(logoSeparator, {
      scaleY: 1,
      duration: 0.4,
      marginLeft: "1rem",
      marginRight: "1rem",
    })
    .from(logoFirstText, { opacity: 0, x: 20, duration: 0.6 })
    .from(logoSecondText, { opacity: 0, x: -20, duration: 0.6 })
    .to(logoSeparator, {
      scaleY: 0,
      duration: 0.6,
      margin: "0",
      ease: "power2.inOut",
    })
    .to(bgAnimationSecondary, {
      scaleY: 1,
      transformOrigin: "bottom",
      duration: 0.6,
      ease: "power2.inOut",
    })
    .to(
      [logoFirstText, logoSecondText],
      {
        color: "white",
        stagger: 0.1,
      },
      "<"
    )
    .to(animationContainer, {
      duration: 1,
      opacity: 0,
      ease: "power2.inOut",
      onComplete: () => {
        animationContainer.remove();
        logoContainer.remove();
      },
    });
</script>
